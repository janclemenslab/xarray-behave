name: Publish to Anaconda.org

on:
  release:
    types:
      - published
  workflow_dispatch:
    inputs:
      logLevel:
        description: 'Log level'
        required: true
        default: 'warning'
      tags:
        description: 'manual run'

jobs:
  publish:
    runs-on: ${{ matrix.os }}
    strategy:
      fail-fast: False
      matrix:
        python-version: [3.9]  # , '3.10']
        os: [ubuntu-latest]  # , windows-latest, macOS-latest]
    steps:
    - uses: actions/checkout@v1
    - name: publish-to-conda
      uses: janclemenslab/conda-build-publish-action@v1
      with:
        subDir: 'conda/das'
        AnacondaToken: ${{ secrets.ANACONDA_TOKEN }}
        AnacondaUser: ncb
        pyver: ${{ matrix.python-version }}
